// Copyright 2013 Lauren Sperber
// https://github.com/lauren/specify-me/blob/master/LICENSE
//
// A more efficient way to calculate selector specificity. If you want to preserve the
// hierarchy of the inputted selectors, try the version called
// specificity-calculator-with-hierarchy.js
(function(e){function f(e){return e.reduce(function(e,t){return e.add(l(t),t),e},new a)}var t=[":link",":visited",":hover",":active",":target",":lang",":focus",":enabled",":disabled",":checked",":indeterminate",":root",":nth-child",":nth-last-child",":nth-of-type",":nth-last-of-type",":first-child",":last-child",":first-of-type",":last-of-type",":only-child",":only-of-type",":empty"],n=["::first-line","::first-letter","::before","::after"],r=/(\.|#|:|\[|\*|\+|\<|\>|\~|\s)/,i=/^(\*|\+|\<|\>|\~|\s|\(|\))+/,s=function(e){return typeof e=="string"?o(e):e.map(o)},o=function(e){var t=f(u(e)),n=[["ids"],["classes","pseudoClasses","attributes"],["nodes","pseudoElements"]];return t.score=n.map(function(e){return t.getCategories(e).length}),t},u=function(e){e=e.replace(i,"");if(e.length===0)return[];var t=/^[\:\:]/.test(e)?e.slice(2).search(r):e.slice(1).search(r),t=t>=0?t+1:e.length,n=e.slice(0,t),s=e.slice(t);return[n].concat(u(s))},a=function(){this.categories={}};a.prototype={add:function(e,t){return this.categories[e]===undefined&&(this.categories[e]=[]),this.categories[e].push(t),this},getCategories:function(e){if(e.length===0)return[];var t=this.categories[e[0]];return(t===undefined?[]:t).concat(this.getCategories(e.slice(1)))}};var l=function(e){switch(e.charAt(0)){case"#":return"ids";case".":return"classes";case"[":return"attributes";case":":return string.slice(1,2)===":"?"pseudoElements":"pseudoClasses";default:return"nodes"}};if(Array.prototype.indexOf===undefined)var c=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1};Array.prototype.map===undefined&&(Array.prototype.map=function(e){var t=[];for(var n=0;n<this.length;n++)t.push(e(this[n]));return t}),Array.prototype.reduce===undefined&&(Array.prototype.reduce=function(e,t){if(this.length===0&&t===undefined)throw new TypeError("Can't reduce an empty array with no initial value");var n=0;t===undefined&&(t=this[0],n=1);for(var r=this.length;n<r;n++)t=e(t,this[n]);return t}),e.specifyMe=s})(this);