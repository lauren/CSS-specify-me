// Copyright 2013 Lauren Sperber
// https://github.com/lauren/specify-me/blob/master/LICENSE
// 
// A more efficient way to calculate selector specificity. If you want to preserve the
// hierarchy of the inputted selectors, try the version called 
// specificity-calculator-with-hierarchy.js
(function(e){var t=[":link",":visited",":hover",":active",":target",":lang",":focus",":enabled",":disabled",":checked",":indeterminate",":root",":nth-child",":nth-last-child",":nth-of-type",":nth-last-of-type",":first-child",":last-child",":first-of-type",":last-of-type",":only-child",":only-of-type",":empty"],n=["::first-line","::first-letter","::before","::after"],r=/(\.|#|:|\[|\*|\+|\<|\>|\~|\s)/,i=/(\.|:|\[|\*|\+|\<|\>|\~|\s)/,s=/(\*|\+|\<|\>|\~|\s)/,o=function(e){return typeof e=="string"?a(e):u(e)},u=function(e){var t=[],n=function(e){return e.length===0?t:(t.push(a(e[0])),e.length>1&&n(e.slice(1,e.length)),t)};return n(e)},a=function(e){var t=f(e),n={score:[0,0,0],components:{ids:[],elementsAndPseudoElements:[],classesPseudoClassesAndAttributes:[]}};for(type in t)switch(type){case"nodes":case"pseudoElements":n.score[2]+=t[type].length,n.components.elementsAndPseudoElements=n.components.elementsAndPseudoElements.concat(t[type]);break;case"classes":case"pseudoClasses":case"attributes":n.score[1]+=t[type].length,n.components.classesPseudoClassesAndAttributes=n.components.classesPseudoClassesAndAttributes.concat(t[type]);break;case"ids":n.score[0]+=t[type].length,n.components.ids=t[type]}return n},f=function(e){var t={ids:[],classes:[],attributes:[],pseudos:[],pseudoClasses:[],pseudoElements:[],nodes:[],wildcardAndCombinators:[]},n=function(e){e=o(e);if(e.length===0)return;var s=l(e),u=e.charAt(0)==="#"?e.slice(1,e.length).search(i):e.slice(1,e.length).search(r),a;u=u>=0?u:e.length,a=e.slice(0,u+1),t[s].push(a),n(e.slice(u+1,e.length))},o=function(e){return s.test(e.slice(0,1))?o(e.slice(1,e.length)):e};return n(e),c(t),t},l=function(e){switch(e.charAt(0)){case"*":case"+":case"~":case"<":case">":return"wildcardAndCombinators";case"#":return"ids";case".":return"classes";case"[":return"attributes";case":":return"pseudos";default:return"nodes"}},c=function(e){if(e.pseudos){for(var r=0;r<e.pseudos.length;r++){if(/(\(|\))/.test(e.pseudos[r])){var i=e.pseudos[r].split(/(\(|\))/g);e.pseudos[r]=i[0],h(i.slice(1,i.length))}p(n,":"+e.pseudos[r])?e.pseudoElements.push(":"+e.pseudos[r]):p(t,e.pseudos[r])&&e.pseudoClasses.push(e.pseudos[r])}delete e.pseudos}},h=function(e,t){for(var n=0;n<e.length;n++)e[n].charAt[0]===":"&&t.pseudos.push(e[n])},p=function(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return!0;return!1};e.specifyMe=o})(this);